(this["webpackJsonphotel-booking-client"]=this["webpackJsonphotel-booking-client"]||[]).push([[0],{148:function(e,t,r){},615:function(e,t,r){},616:function(e,t,r){},617:function(e,t,r){"use strict";r.r(t);var n=r(124),a=r.n(n),s=(r(148),r(6)),c=r.n(s),o=r(11),i=r(7),u=r(8),l=r(28),h=r(14),p=r(13),j=r(4),b=r.n(j),d=r(136),O=r(54),f=r(135),v=r(69),x="https://cy3zoyyuyd.execute-api.us-east-1.amazonaws.com/prod/",m={REGION:"us-east-1",USER_POOL_ID:"us-east-1_Bv9WLY26g",APP_CLIENT_ID:"3762gu0me9dcir4k5bb6q7d0in",IDENTITY_POOL_ID:"us-east-1:485e4406-875b-48d2-93df-7660c915caae",HOTELS_PHOTOS_BUCKET:"hotels-photos-0acb0d48ddc3",api:{baseUrl:x,hotelsUrl:"".concat(x,"hotels")}},y=r(29);v.default.configure({Auth:{mandatorySignIn:!1,region:m.REGION,userPoolId:m.USER_POOL_ID,userPoolWebClientId:m.APP_CLIENT_ID,identityPoolId:m.IDENTITY_POOL_ID,authenticationFlowType:"USER_PASSWORD_AUTH"}});var g=function(){function e(){Object(i.a)(this,e)}return Object(u.a)(e,[{key:"login",value:function(){var e=Object(o.a)(c.a.mark((function e(t,r){var n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f.a.signIn(t,r);case 3:return n=e.sent,e.abrupt("return",{congnitoUser:n,userName:n.getUsername()});case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",void 0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getAWSTemporaryCreds",value:function(){var e=Object(o.a)(c.a.mark((function e(t){var r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="cognito-idp.".concat(m.REGION,".amazonaws.com/").concat(m.USER_POOL_ID),y.config.credentials=new y.CognitoIdentityCredentials({IdentityPoolId:m.IDENTITY_POOL_ID,Logins:Object(O.a)({},r,t.getSignInUserSession().getIdToken().getJwtToken())},{region:m.REGION}),e.next=4,this.refreshCredentials();case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"refreshCredentials",value:function(){var e=Object(o.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,t){y.config.credentials.refresh((function(r){r?t(r):e()}))})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"getUserAttributes",value:function(){var e=Object(o.a)(c.a.mark((function e(t){var r,n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=[],e.next=3,f.a.userAttributes(t.congnitoUser);case 3:return n=e.sent,r.push.apply(r,Object(d.a)(n)),e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),w=r(15),k=Object(w.a)(),S=r(2),I=function(e){Object(h.a)(r,e);var t=Object(p.a)(r);function r(){var e;Object(i.a)(this,r);for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return(e=t.call.apply(t,[this].concat(a))).state={userName:"",password:"",loginAttempted:!1,loginSuccessfull:!1},e}return Object(u.a)(r,[{key:"setUsername",value:function(e){this.setState({userName:e.target.value})}},{key:"setPassword",value:function(e){this.setState({password:e.target.value})}},{key:"handleSubmit",value:function(){var e=Object(o.a)(c.a.mark((function e(t){var r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),this.setState({loginAttempted:!0}),e.next=4,this.props.authService.login(this.state.userName,this.state.password);case 4:(r=e.sent)?(this.setState({loginSuccessfull:!0}),this.props.setUser(r),k.push("/profile")):this.setState({loginSuccessfull:!1});case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e,t=this;return this.state.loginAttempted&&(e=this.state.loginSuccessfull?Object(S.jsx)("label",{children:" Login was a Success!"}):Object(S.jsx)("label",{children:" Login was a Failure!"})),Object(S.jsxs)("div",{className:"",children:[Object(S.jsx)("h2",{children:"Login Page"}),Object(S.jsxs)("form",{onSubmit:function(e){return t.handleSubmit(e)},children:[Object(S.jsx)("input",{value:this.state.userName,onChange:function(e){return t.setUsername(e)}}),Object(S.jsx)("br",{}),Object(S.jsx)("input",{value:this.state.password,onChange:function(e){return t.setPassword(e)},type:"password"}),Object(S.jsx)("br",{}),Object(S.jsx)("input",{type:"submit",value:"Login"})]}),e]})}}]),r}(b.a.Component),C=r(10),U=r(23),N=function(e){Object(h.a)(r,e);var t=Object(p.a)(r);function r(){return Object(i.a)(this,r),t.apply(this,arguments)}return Object(u.a)(r,[{key:"render",value:function(){var e;return e=this.props.user?Object(S.jsx)(U.a,{to:"/logout",style:{float:"right"},children:this.props.user.userName}):Object(S.jsx)(U.a,{to:"/login",style:{float:"right"},children:"Login"}),Object(S.jsxs)("div",{className:"navbar",children:[Object(S.jsx)(U.a,{to:"/",children:" Home "}),Object(S.jsx)(U.a,{to:"/profile",children:"Profile"}),Object(S.jsx)(U.a,{to:"/hotels",children:"Hotels"}),e]})}}]),r}(b.a.Component),L=function(e){Object(h.a)(r,e);var t=Object(p.a)(r);function r(){return Object(i.a)(this,r),t.apply(this,arguments)}return Object(u.a)(r,[{key:"render",value:function(){return Object(S.jsx)("div",{children:"Welcome to the Homepage Page!!"})}}]),r}(b.a.Component),P=r(55),H=function(e){Object(h.a)(r,e);var t=Object(p.a)(r);function r(){var e;Object(i.a)(this,r);for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return(e=t.call.apply(t,[this].concat(a))).state={userAttributes:[]},e}return Object(u.a)(r,[{key:"componentDidMount",value:function(){var e=Object(o.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.props.user){e.next=5;break}return e.next=3,this.props.authService.getUserAttributes(this.props.user);case 3:t=e.sent,this.setState({userAttributes:t});case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"renderUserAttributes",value:function(){var e,t=[],r=Object(P.a)(this.state.userAttributes);try{for(r.s();!(e=r.n()).done;){var n=e.value;t.push(Object(S.jsxs)("tr",{children:[Object(S.jsx)("td",{children:n.Name}),Object(S.jsx)("td",{children:n.Value})]},n.Name))}}catch(a){r.e(a)}finally{r.f()}return Object(S.jsx)("table",{children:Object(S.jsx)("tbody",{children:t})})}},{key:"render",value:function(){var e;return e=this.props.user?Object(S.jsxs)("div",{children:[Object(S.jsxs)("h3",{children:["Hello ",this.props.user.userName]}),"Here are your attributes:",this.renderUserAttributes()]}):Object(S.jsxs)("div",{children:["Please ",Object(S.jsx)(U.a,{to:"login",children:"Login"})]}),Object(S.jsxs)("div",{children:["Welcome ti the profile page!",e]})}}]),r}(b.a.Component),T=r.p+"static/media/default.a3f5c684.jpg",_=(r(615),function(e){Object(h.a)(r,e);var t=Object(p.a)(r);function r(){return Object(i.a)(this,r),t.apply(this,arguments)}return Object(u.a)(r,[{key:"renderImage",value:function(){return this.props.photoURL?Object(S.jsx)("img",{src:this.props.photoURL,alt:""}):Object(S.jsx)("img",{src:T,alt:""})}},{key:"render",value:function(){var e=this;return Object(S.jsxs)("div",{className:"hotelComponent",children:[this.renderImage(),Object(S.jsx)("label",{className:"name",children:this.props.name}),Object(S.jsx)("br",{}),Object(S.jsx)("label",{className:"hotelId",children:this.props.hotelId}),Object(S.jsx)("br",{}),Object(S.jsx)("label",{className:"location",children:this.props.location}),Object(S.jsx)("br",{}),Object(S.jsx)("button",{onClick:function(){return e.props.reserveHotel(e.props.hotelId)},children:"Reserve"})]})}}]),r}(j.Component)),A=(r(616),function(e){Object(h.a)(r,e);var t=Object(p.a)(r);function r(){return Object(i.a)(this,r),t.apply(this,arguments)}return Object(u.a)(r,[{key:"render",value:function(){var e=this;return this.props.show?Object(S.jsx)("div",{className:"modal",children:Object(S.jsxs)("div",{className:"modal-content",children:[Object(S.jsx)("h2",{children:"You tried to resrve and ..."}),Object(S.jsx)("h3",{className:"modalText",children:this.props.content}),Object(S.jsx)("button",{onClick:function(){return e.props.close()},children:"Ok, close"})]})}):null}}]),r}(j.Component)),E=function(e){Object(h.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).state={hotels:[],showModal:!1,modalContent:""},n.reserveHotel=n.reserveHotel.bind(Object(l.a)(n)),n.closeModal=n.closeModal.bind(Object(l.a)(n)),n}return Object(u.a)(r,[{key:"componentDidMount",value:function(){var e=Object(o.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.props.dataService.getHotels();case 2:t=e.sent,this.setState({hotels:t});case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"reserveHotel",value:function(){var e=Object(o.a)(c.a.mark((function e(t){var r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.props.dataService.reserveHotels(t);case 2:(r=e.sent)?this.setState({showModal:!0,modalContent:"You reserved the hotel with id ".concat(t," and got the reservation number ").concat(r)}):this.setState({showModal:!0,modalContent:"You can't reserve the hotel with id ".concat(t)});case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"renderHotels",value:function(){var e,t=[],r=Object(P.a)(this.state.hotels);try{for(r.s();!(e=r.n()).done;){var n=e.value;t.push(Object(S.jsx)(_,{location:n.location,name:n.name,photoURL:n.photoURL,hotelId:n.hotelId,reserveHotel:this.reserveHotel}))}}catch(a){r.e(a)}finally{r.f()}return t}},{key:"closeModal",value:function(){this.setState({showModal:!1,modalContent:""})}},{key:"render",value:function(){return Object(S.jsxs)("div",{children:[Object(S.jsx)("h2",{children:"Welcome to the Hotels page!"}),Object(S.jsx)(U.a,{to:"/createHotel",children:"Create Hotel"}),Object(S.jsx)("br",{}),this.renderHotels(),Object(S.jsx)(A,{close:this.closeModal,content:this.state.modalContent,show:this.state.showModal})]})}}]),r}(j.Component);y.config.update({region:m.REGION});var D=function(){function e(){Object(i.a)(this,e)}return Object(u.a)(e,[{key:"createHotel",value:function(){var e=Object(o.a)(c.a.mark((function e(t){var r,n,a,s,o;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.photo){e.next=6;break}return e.next=3,this.uploadPublicFile(t.photo,m.HOTELS_PHOTOS_BUCKET);case 3:r=e.sent,t.photoURL=r,t.photo=void 0;case 6:return n=m.api.hotelsUrl,a={method:"POST",body:JSON.stringify(t)},e.next=10,fetch(n,a);case 10:return s=e.sent,e.next=13,s.json();case 13:return o=e.sent,e.abrupt("return",JSON.stringify(o.id));case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"uploadPublicFile",value:function(){var e=Object(o.a)(c.a.mark((function e(t,r){var n,a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Math.random().toString(36).slice(2)+t.name,e.next=3,new y.S3({region:m.REGION}).upload({Bucket:r,Key:n,Body:t,ACL:"public-read"}).promise();case 3:return a=e.sent,e.abrupt("return",a.Location);case 5:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getHotels",value:function(){var e=Object(o.a)(c.a.mark((function e(){var t,r,n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=m.api.hotelsUrl,e.next=3,fetch(t,{method:"GET"});case 3:return r=e.sent,e.next=6,r.json();case 6:return n=e.sent,e.abrupt("return",n);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"reserveHotels",value:function(){var e=Object(o.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("123"!==t){e.next=4;break}return e.abrupt("return","5555");case 4:return e.abrupt("return",void 0);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),R=r(134),M=function(e){Object(h.a)(r,e);var t=Object(p.a)(r);function r(){var e;Object(i.a)(this,r);for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return(e=t.call.apply(t,[this].concat(a))).state={name:"",description:"",location:"",photoURL:""},e}return Object(u.a)(r,[{key:"setName",value:function(e){this.setState({name:e.target.value})}},{key:"setLocation",value:function(e){this.setState({location:e.target.value})}},{key:"setDescription",value:function(e){this.setState({description:e.target.value})}},{key:"setPhotoUrl",value:function(e){e.target.files&&e.target.files[0]&&this.setState({photo:e.target.files[0]})}},{key:"handleSubmit",value:function(){var e=Object(o.a)(c.a.mark((function e(t){var r,n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),r=Object(R.a)({},this.state),e.prev=2,e.next=5,this.props.dataService.createHotel(r);case 5:n=e.sent,alert("Created hotel with id: ".concat(n)),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),alert("Error while creating hotel: ".concat("Failed :D"));case 12:case"end":return e.stop()}}),e,this,[[2,9]])})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e,t=this;if(this.state.photo){var r=URL.createObjectURL(this.state.photo);e=Object(S.jsx)("img",{alt:"",src:r})}else e=Object(S.jsx)("div",{});return Object(S.jsxs)("form",{onSubmit:function(e){return t.handleSubmit(e)},children:[Object(S.jsxs)("label",{children:["Name:",Object(S.jsx)("br",{}),Object(S.jsx)("input",{name:"hotel name",value:this.state.name,onChange:function(e){return t.setName(e)}})]}),Object(S.jsx)("br",{}),Object(S.jsxs)("label",{children:["Location:",Object(S.jsx)("br",{}),Object(S.jsx)("input",{name:"hotel location",value:this.state.location,onChange:function(e){return t.setLocation(e)}})]}),Object(S.jsx)("br",{}),Object(S.jsxs)("label",{children:["Description:",Object(S.jsx)("br",{}),Object(S.jsx)("input",{name:"hotel location",value:this.state.description,onChange:function(e){return t.setDescription(e)}})]}),Object(S.jsx)("br",{}),Object(S.jsxs)("label",{children:["Photo:",Object(S.jsx)("br",{}),Object(S.jsx)("input",{name:"photo",type:"file",onChange:function(e){return t.setPhotoUrl(e)}})]}),Object(S.jsx)("br",{}),e,Object(S.jsx)("br",{}),Object(S.jsx)("input",{"data-test":"submit-button",type:"submit",value:"Create hpace"})]})}}]),r}(j.Component),W=function(e){Object(h.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).authService=new g,n.dataService=new D,n.state={user:void 0},n.setUser=n.setUser.bind(Object(l.a)(n)),n}return Object(u.a)(r,[{key:"setUser",value:function(){var e=Object(o.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({user:t}),e.next=3,this.authService.getAWSTemporaryCreds(t.congnitoUser);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){return Object(S.jsx)("div",{className:"wrapper",children:Object(S.jsx)(C.b,{history:k,children:Object(S.jsxs)("div",{children:[Object(S.jsx)(N,{user:this.state.user}),Object(S.jsxs)(C.c,{children:[Object(S.jsx)(C.a,{exact:!0,path:"/",component:L}),Object(S.jsx)(C.a,{exact:!0,path:"/login",children:Object(S.jsx)(I,{authService:this.authService,setUser:this.setUser})}),Object(S.jsx)(C.a,{exact:!0,path:"/profile",children:Object(S.jsx)(H,{authService:this.authService,user:this.state.user})}),Object(S.jsx)(C.a,{exact:!0,path:"/hotels",children:Object(S.jsx)(E,{dataService:this.dataService})}),Object(S.jsx)(C.a,{exact:!0,path:"/createHotel",children:Object(S.jsx)(M,{dataService:this.dataService})})]})]})})})}}]),r}(b.a.Component);a.a.render(Object(S.jsx)(W,{}),document.getElementById("root"))},65:function(e,t){}},[[617,1,2]]]);
//# sourceMappingURL=main.54e01122.chunk.js.map